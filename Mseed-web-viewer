<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniSEED Web Viewer</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
        }
        .container {
            max-width: 1000px;
            margin: auto;
        }
        .section {
            margin-bottom: 40px;
        }
        #trace-info {
            white-space: pre-wrap;
            background-color: #eee;
            padding: 10px;
            border: 1px solid #ccc;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>MiniSEED Web Viewer (Prototype)</h1>

        <div class="section">
            <label for="fileInput">Upload .mseed file:</label>
            <input type="file" id="fileInput" accept=".mseed">
            <p><em>(Note: .mseed parsing not yet supported. Using mock data.)</em></p>
        </div>

        <div class="section">
            <h2>Trace Information</h2>
            <div id="trace-info">No data loaded.</div>
        </div>

        <div class="section">
            <h2>Waveform Plot</h2>
            <div id="waveform" style="height: 300px;"></div>
        </div>

        <div class="section">
            <h2>FFT Spectrum</h2>
            <div id="fft" style="height: 300px;"></div>
        </div>
    </div>

    <script>
        // Mock Data
        const fs = 100; // sample rate Hz
        const time = Array.from({length: 1000}, (_, i) => i / fs);
        const data = time.map(t => Math.sin(2 * Math.PI * 5 * t)); // 5 Hz sine wave

        // Trace info mock display
        document.getElementById("trace-info").innerText = `Trace 1:\n  - Sampling Rate: ${fs} Hz\n  - Length: ${data.length} samples\n  - Duration: ${data.length / fs} seconds`;

        // Plot waveform
        Plotly.newPlot('waveform', [{
            x: time,
            y: data,
            type: 'scatter',
            mode: 'lines',
            name: 'Raw Signal'
        }], {
            margin: { t: 30 },
            xaxis: { title: 'Time (s)' },
            yaxis: { title: 'Amplitude' }
        });

        // Compute FFT
        const fftSize = data.length;
        const fft = data.map((_, i) => {
            return Math.sin(2 * Math.PI * i / fftSize * 5); // mock FFT
        });
        const freq = Array.from({length: fftSize / 2}, (_, i) => i * fs / fftSize);
        const spectrum = freq.map(f => Math.random() * 10); // random spectrum for now

        // Plot FFT
        Plotly.newPlot('fft', [{
            x: freq,
            y: spectrum,
            type: 'scatter',
            mode: 'lines',
            name: 'FFT Spectrum'
        }], {
            margin: { t: 30 },
            xaxis: { title: 'Frequency (Hz)' },
            yaxis: { title: 'Amplitude' }
        });
    </script>
</body>
</html>
